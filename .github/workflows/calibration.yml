name: Daily Smart Calibration

on:
  schedule:
    # Runs every 15 minutes between 22:00 and 23:59 UTC (00:00-02:00 Kyiv time)
    - cron: '*/15 22-23 * * *'
  workflow_dispatch:

concurrency:
  group: scheduler-data-sync
  cancel-in-progress: false

jobs:
  calibrate:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      - name: Run Calibration
        run: python scripts/scheduler.py --calibrate
      - name: Commit changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "chore(bot): калібрування карти"
          file_pattern: "scripts/mapping.json database.json"
